models:
- name: client_program
  description: 'The client_program model represents a standardized view of client
    program data from multiple source systems, SW1 and SW2.  Data from these systems
    may differ due to variations in data collection, processing, and storage.  This
    model is used downstream to provide a unified understanding of client programs,
    enabling key analytical use cases such as reporting, metrics calculation, and
    auditability.

    '
  meta:
    owner: data_engineering
    criticality: high
    pii: false
  tests:
  - dbt_utils.unique_combination_of_columns:
      combination_of_columns:
      - CLIENT_PROGRAM_ID
      - DATA_SOURCE
      where: "SOURCE_DELETED = false"

  columns:
  - name: CLIENT_PROGRAM_SURROGATE_KEY
    description: 'A unique identifier for each client program, generated by combining
      CLIENT_PROGRAM_ID and DATA_SOURCE.  This key ensures row uniqueness and facilitates
      data integration across different source systems.

      '
  - name: DATA_SOURCE
    description: 'The source system from which the client program data originates,
      either SW1 or SW2.  This column is crucial for tracking data provenance and
      handling potential discrepancies between sources.

      '
    tests:
    - not_null
  - name: DATE_FROM
    description: 'The start date of the client program, transformed to a standardized
      date format.  This column is essential for analyzing program duration and overlaps.

      '
  - name: DATE_TO
    description: 'The end date of the client program, transformed to a standardized
      date format.  This column is necessary for evaluating program completion and
      termination.

      '
  - name: COMMENTS
    description: 'Additional comments or notes related to the client program, transformed
      to a standardized string format.  This column provides context for understanding
      program specifics and exceptions.

      '
  - name: FREQUENT_PGM_CODE
    description: 'A code representing the frequent program associated with the client,
      transformed to a standardized string format.  This column is vital for analyzing
      program participation and loyalty.

      '
  - name: CLIENT_ID
    description: 'A unique identifier for the client, transformed to a standardized
      numeric format.  This column is necessary for linking client program data to
      other client-related data.

      '
  - name: CLIENT_PROGRAM_ID
    description: 'A unique identifier for the client program, transformed to a standardized
      numeric format.  This column, combined with DATA_SOURCE, ensures row uniqueness
      and facilitates data integration.

      '
    tests:
    - not_null
  - name: FREQUENT_PGM_ACCOUNT
    description: 'The account associated with the frequent program, transformed to
      a standardized string format.  This column is essential for analyzing program
      accounting and rewards.

      '
  - name: CLUB_ACCOUNT
    description: 'The club account associated with the client program, transformed
      to a standardized string format.  This column is necessary for evaluating program
      benefits and membership.

      '
  - name: CLUB_TYPE
    description: 'The type of club associated with the client program, transformed
      to a standardized string format.  This column is vital for analyzing program
      participation and preferences.

      '
  - name: TIER_LEVEL
    description: 'The tier level associated with the client program, transformed to
      a standardized string format.  This column is necessary for evaluating program
      status and loyalty.

      '
  - name: LAST_UPDATED_TIMESTAMP
    description: 'The timestamp when the client program data was last updated, transformed
      to a standardized datetime format.  This column is essential for tracking data
      freshness and changes.

      '
  - name: SOURCE_DELETED
    description: A flag indicating whether the client program data was deleted in
      the source system, transformed to a standardized boolean format.  This column
      is necessary for handling data removal and updates.
