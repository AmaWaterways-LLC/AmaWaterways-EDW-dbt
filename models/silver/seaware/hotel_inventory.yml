models:
  - name: hotel_inventory
    description: >
      The hotel_inventory model represents a standardized view of hotel room inventory across multiple source systems, including SW1 and SW2. This model is used to provide a unified understanding of hotel room availability and occupancy, enabling key analytical use cases such as reporting, metrics, and auditability. Data from multiple systems may differ due to variations in data collection and processing methods. This model is used downstream to support business decision-making and strategic planning.

    meta:
      owner: data_engineering
      criticality: high
      pii: false

    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - INV_RECORD_ID
            - DATA_SOURCE

    columns:
      - name: HOTEL_INVENTORY_SURROGATE_KEY
        description: >
          A unique identifier for each hotel inventory record, generated by combining INV_RECORD_ID and DATA_SOURCE. This column serves as the primary key for the model, ensuring row uniqueness.

        tests:
          - not_null

      - name: DATA_SOURCE
        description: >
          The source system from which the hotel inventory data was obtained, either SW1 or SW2. This column is used to track data provenance and identify potential discrepancies between source systems.

      - name: HOTEL_ROOM_TYPE
        description: >
          The type of hotel room, such as single, double, or suite. This column is used to analyze room type distribution and occupancy patterns.

      - name: HOTEL_ID
        description: >
          A unique identifier for the hotel. This column is used to analyze hotel-specific data and trends.

      - name: HOTEL_DAY
        description: >
          The date for which the hotel inventory data is applicable. This column is used to analyze daily occupancy patterns and trends.

      - name: ACTUAL_ROOMS
        description: >
          The actual number of rooms available in the hotel. This column is used to analyze room availability and occupancy rates.

      - name: HOTEL_SPACE_TYPE
        description: >
          The type of hotel space, such as meeting room or event space. This column is used to analyze space utilization and revenue streams.

      - name: INV_RECORD_ID
        description: >
          A unique identifier for the inventory record. This column, combined with DATA_SOURCE, serves as the primary key for the model, ensuring row uniqueness.

        tests:
          - not_null

      - name: INVENTORY_MODE
        description: >
          The mode of inventory management, such as manual or automated. This column is used to analyze inventory management practices and optimize processes.

      - name: LAST_UPDATED_TIMESTAMP
        description: >
          The timestamp when the hotel inventory data was last updated. This column is used to track data freshness and identify potential data staleness issues.

      - name: SOURCE_DELETED
        description: >
          A flag indicating whether the hotel inventory record has been deleted in the source system. This column is used to track data lineage and identify potential data inconsistencies.