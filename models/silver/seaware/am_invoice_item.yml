models:
- name: am_invoice_item
  description: 'The am_invoice_item model represents individual items within an invoice,  standardized
    across multiple source systems. Data from different systems  may differ due to
    variations in data entry, formatting, or system-specific  fields. This model is
    used downstream for reporting, metrics, and auditing  purposes, providing a unified
    view of invoice items. Key analytical use  cases include analyzing revenue streams,
    tracking sales trends, and  identifying discrepancies in invoice data.

    '
  meta:
    owner: data_engineering
    criticality: high
    pii: false
  tests:
  - dbt_utils.unique_combination_of_columns:
      combination_of_columns:
      - AM_INVOICE_ITEM_ID
      - DATA_SOURCE
      where: "SOURCE_DELETED = false"

  columns:
  - name: AM_INVOICE_ITEM_SURROGATE_KEY
    description: 'A unique identifier for each invoice item, generated by combining
      the  AM_INVOICE_ITEM_ID and DATA_SOURCE columns. This key ensures row  uniqueness
      across multiple source systems.

      '
  - name: DATA_SOURCE
    description: 'The source system from which the invoice item data originated. This  column
      is used to track data lineage and identify potential  discrepancies between
      systems.

      '
    tests:
    - not_null
  - name: AM_INVOICE_ITEM_ID
    description: 'A unique identifier for the invoice item within its source system.  This
      column, combined with DATA_SOURCE, forms the primary key for  this model.

      '
    tests:
    - not_null
  - name: AM_ORDER_ID
    description: 'The identifier for the order associated with this invoice item.
      This  column is used to link invoice items to their corresponding orders.

      '
  - name: AM_INVC_ITEM_TYPE
    description: 'The type of invoice item, such as a product or service. This column  is
      used to categorize and analyze invoice items.

      '
  - name: AMENITY_CODE
    description: 'A code representing the amenity associated with this invoice item.  This
      column is used to track and analyze amenity-related data.

      '
  - name: AM_INVC_ITEM_SUBTYPE
    description: 'A subcategory for the invoice item type, providing further  classification.
      This column is used to refine analysis and reporting.

      '
  - name: PRICE_PER_UNIT
    description: 'The price per unit of the invoice item. This column is used to  calculate
      total costs and revenue.

      '
  - name: PERCENT
    description: 'A percentage value associated with the invoice item, such as a  discount
      or tax rate. This column is used to calculate adjusted  amounts.

      '
  - name: AMOUNT
    description: 'The total amount of the invoice item. This column is used to track  revenue
      and calculate totals.

      '
  - name: QUANTITY
    description: 'The quantity of the invoice item. This column is used to calculate  totals
      and track inventory.

      '
  - name: ITEM_TOTAL
    description: 'The total cost of the invoice item, calculated by multiplying the  price
      per unit by the quantity. This column is used to track revenue  and calculate
      totals.

      '
  - name: PROMO_CODE
    description: 'A promotional code associated with the invoice item, such as a  discount
      or special offer. This column is used to track promotional  activity.

      '
  - name: ITEM_VALID
    description: 'A flag indicating whether the invoice item is valid or not. This  column
      is used to identify and exclude invalid items from analysis.

      '
  - name: SOURCE_DELETED
    description: 'A flag indicating whether the invoice item has been deleted in the  source
      system. This column is used to track data lineage and identify  removed items.

      '
  - name: LAST_UPDATED_TIMESTAMP
    description: The timestamp when the invoice item was last updated. This column
      is  used to track data freshness and identify recent changes.
