models:
- name: hotel_city_link
  description: 'The hotel_city_link model represents the relationship between hotels
    and cities,  providing a standardized view of this data from multiple source systems
    (SW1 and SW2).  This model is critical for downstream analytics and reporting,
    enabling insights into hotel  and city priorities, as well as tracking changes
    to these relationships over time.  Key analytical use cases include analyzing
    hotel and city performance, identifying trends  in hotel-city relationships, and
    auditing changes to these relationships.

    '
  meta:
    owner: data_engineering
    criticality: high
    pii: false
  tests:
  - dbt_utils.unique_combination_of_columns:
      combination_of_columns:
      - HOTEL_CITY_LINK_ID
      - DATA_SOURCE
      where: "SOURCE_DELETED = false"

  columns:
  - name: HOTEL_CITY_LINK_SURROGATE_KEY
    description: 'A unique identifier for each hotel-city link, generated by combining
      the HOTEL_CITY_LINK_ID  and DATA_SOURCE columns. This key ensures that each
      record is uniquely identifiable,  even in cases where the same HOTEL_CITY_LINK_ID
      exists in both source systems.

      '
  - name: DATA_SOURCE
    description: 'The source system from which the data was extracted (either SW1
      or SW2). This column  is used to track the origin of each record and ensure
      that data from different systems  is properly differentiated.

      '
  - name: COMMENTS
    description: 'Free-text comments related to the hotel-city link. This column may
      contain additional  context or information about the relationship between the
      hotel and city.

      '
  - name: DATE_FROM
    description: 'The start date of the hotel-city link. This column represents the
      date from which the  relationship between the hotel and city is considered active.

      '
  - name: DATE_TO
    description: 'The end date of the hotel-city link. This column represents the
      date until which the  relationship between the hotel and city is considered
      active.

      '
  - name: HOTEL_CITY_LINK_ID
    description: 'A unique identifier for the hotel-city link in the source system.
      This column is used  in combination with the DATA_SOURCE column to generate
      the HOTEL_CITY_LINK_SURROGATE_KEY.  As a primary key column, it ensures that
      each record is uniquely identifiable within  its source system.

      '
    tests:
    - not_null
  - name: HOTEL_PRIORITY
    description: 'The priority of the hotel in the hotel-city link. This column represents
      the relative  importance or ranking of the hotel within the context of the city.

      '
  - name: CITY_CODE
    description: 'The code or identifier for the city in the hotel-city link. This
      column represents the  city''s unique identifier or code.

      '
  - name: HOTEL_ID
    description: 'The unique identifier for the hotel in the hotel-city link. This
      column represents the  hotel''s unique identifier.

      '
  - name: CITY_PRIORITY
    description: 'The priority of the city in the hotel-city link. This column represents
      the relative  importance or ranking of the city within the context of the hotel.

      '
  - name: LAST_UPDATED_TIMESTAMP
    description: 'The timestamp when the record was last updated in the source system.
      This column is  used to track changes to the data over time.

      '
  - name: SOURCE_DELETED
    description: A flag indicating whether the record has been deleted in the source
      system. This column  is used to track the status of the record in the source
      system.
