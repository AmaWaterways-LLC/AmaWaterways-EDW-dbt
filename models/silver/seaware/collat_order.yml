models:
  - name: collat_order
    description: >
      The collat_order model represents a unified view of order data from multiple source systems, SW1 and SW2. 
      Data from these systems may differ due to variations in data collection, processing, or timing. 
      This standardized model is used downstream for reporting, analytics, and auditability, providing a single source of truth for order data. 
      Key analytical use cases include tracking order status, analyzing order volume by source, and monitoring fulfillment rates.

    meta:
      owner: data_engineering
      criticality: high
      pii: false

    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - ORDER_ID
            - DATA_SOURCE

    columns:
      - name: COLLAT_ORDER_SURROGATE_KEY
        description: >
          A unique identifier for each order, generated by combining the ORDER_ID and DATA_SOURCE columns. 
          This key ensures that each order is uniquely represented across source systems.

      - name: DATA_SOURCE
        description: >
          The source system from which the order data originated, either SW1 or SW2. 
          This column is used to track data lineage and identify potential discrepancies between sources.

      - name: ORDER_ID
        description: >
          A unique identifier for the order within its source system. 
          This column, combined with DATA_SOURCE, forms the primary key for the collat_order model.

        tests:
          - not_null

      - name: ORDER_DATE
        description: >
          The date on which the order was placed. 
          This column is used for tracking order timing and analyzing order volume over time.

      - name: REQUESTER_ID
        description: >
          The identifier of the individual or entity that placed the order. 
          This column is used for analyzing order patterns by requester.

      - name: REQUESTER_TYPE
        description: >
          The type of requester, such as a customer or internal user. 
          This column is used for segmenting orders by requester type.

      - name: ORDER_CTG
        description: >
          The category or type of order, such as a product or service. 
          This column is used for analyzing order patterns by category.

      - name: ORDER_STATUS
        description: >
          The current status of the order, such as pending or fulfilled. 
          This column is used for tracking order fulfillment rates and identifying potential issues.

      - name: PROVIDER_CODE
        description: >
          The code or identifier of the provider or supplier associated with the order. 
          This column is used for analyzing order patterns by provider.

      - name: DELIVERY_CODE
        description: >
          The code or identifier of the delivery method or location associated with the order. 
          This column is used for analyzing order patterns by delivery method.

      - name: DUE_DATE
        description: >
          The date by which the order is expected to be fulfilled or delivered. 
          This column is used for tracking order timing and identifying potential delays.

      - name: AUTHORIZ_DATE
        description: >
          The date on which the order was authorized or approved. 
          This column is used for tracking order approval timing.

      - name: SHIPING_DATE
        description: >
          The date on which the order was shipped or fulfilled. 
          This column is used for tracking order fulfillment timing.

      - name: ADDRESS_TYPE
        description: >
          The type of address associated with the order, such as a billing or shipping address. 
          This column is used for analyzing order patterns by address type.

      - name: COMMENTS
        description: >
          Any additional comments or notes associated with the order. 
          This column is used for capturing order-specific details or issues.

      - name: NEED_CONFIRM
        description: >
          A flag indicating whether the order requires confirmation or approval. 
          This column is used for identifying orders that require additional review.

      - name: REFERRAL_SOURCE
        description: >
          The source or origin of the order referral, such as a marketing campaign or customer referral. 
          This column is used for analyzing order patterns by referral source.

      - name: REFERRAL_DATE
        description: >
          The date on which the order referral was made. 
          This column is used for tracking order referral timing.

      - name: ENTITY_TYPE
        description: >
          The type of entity associated with the order, such as a customer or business. 
          This column is used for segmenting orders by entity type.

      - name: ADDRESS_ID
        description: >
          The identifier of the address associated with the order. 
          This column is used for analyzing order patterns by address.

      - name: OFFICE_LOCATION
        description: >
          The location or office associated with the order, such as a store or warehouse. 
          This column is used for analyzing order patterns by location.

      - name: SOURCE_CODE
        description: >
          The code or identifier of the source system or application that generated the order. 
          This column is used for tracking data lineage and identifying potential issues.

      - name: LAST_UPDATED_TIMESTAMP
        description: >
          The timestamp at which the order data was last updated or synchronized. 
          This column is used for tracking data freshness and identifying potential issues.

      - name: SOURCE_DELETED
        description: >
          A flag indicating whether the order has been deleted or removed from the source system. 
          This column is used for identifying orders that are no longer valid or active.