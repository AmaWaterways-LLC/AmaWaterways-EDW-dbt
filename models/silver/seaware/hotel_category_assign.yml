models:
- name: hotel_category_assign
  description: 'The hotel_category_assign model represents the standardized assignment
    of hotel categories from multiple source systems, SW1 and SW2. The data from these
    systems may differ due to varying update frequencies, data entry practices, or
    system-specific nuances. This model is used downstream to provide a unified view
    of hotel category assignments, enabling accurate reporting, metrics, and auditability.
    Key analytical use cases include tracking changes in hotel categories over time,
    analyzing category distributions across different regions, and identifying discrepancies
    between source systems.

    '
  meta:
    owner: data_engineering
    criticality: high
    pii: false
  tests:
  - dbt_utils.unique_combination_of_columns:
      combination_of_columns:
      - RECORD_ID
      - DATA_SOURCE
      where: "SOURCE_DELETED = false"

  columns:
  - name: HOTEL_CATEGORY_ASSIGN_SURROGATE_KEY
    description: 'A unique surrogate key generated by combining RECORD_ID and DATA_SOURCE,
      ensuring row uniqueness across multiple source systems.

      '
  - name: DATA_SOURCE
    description: 'The source system from which the hotel category assignment data
      originates, either SW1 or SW2.

      '
  - name: DATE_FROM
    description: 'The start date of the hotel category assignment.

      '
  - name: DATE_TO
    description: 'The end date of the hotel category assignment.

      '
  - name: RECORD_ID
    description: 'A unique identifier for the hotel category assignment record within
      the source system.

      '
    tests:
    - not_null
  - name: PRIORITY
    description: 'The priority level of the hotel category assignment.

      '
  - name: HOTEL_ID
    description: 'The identifier of the hotel associated with the category assignment.

      '
  - name: HOTEL_CATEGORY
    description: 'The assigned category of the hotel.

      '
  - name: LAST_UPDATED_TIMESTAMP
    description: 'The timestamp of the last update to the hotel category assignment
      record.

      '
  - name: SOURCE_DELETED
    description: A flag indicating whether the record has been deleted in the source
      system.
