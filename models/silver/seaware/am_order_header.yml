models:
  - name: am_order_header
    description: >
      The am_order_header model represents a standardized view of order headers across multiple systems. 
      Data from different systems may differ due to variations in data formatting, encoding, or business rules. 
      This model is used downstream for reporting, analytics, and auditability, providing a unified understanding of order headers. 
      Key analytical use cases include order tracking, sales performance analysis, and customer behavior insights.

    meta:
      owner: data_engineering
      criticality: high
      pii: false

    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - AM_ORDER_ID
            - DATA_SOURCE

    columns:
      - name: AM_ORDER_HEADER_SURROGATE_KEY
        description: >
          A unique identifier for each order header, generated by combining the AM_ORDER_ID and DATA_SOURCE columns. 
          This surrogate key ensures row uniqueness and facilitates efficient data retrieval.

      - name: DATA_SOURCE
        description: >
          The source system from which the order header data originates. 
          This column helps track data provenance and identify potential discrepancies between systems.

        tests:
          - not_null

      - name: AM_ORDER_ID
        description: >
          A unique identifier for the order, used in conjunction with DATA_SOURCE to create the surrogate key. 
          This column is crucial for order tracking and analysis.

        tests:
          - not_null

      - name: ORDER_DATE
        description: >
          The date on which the order was placed. 
          This column is essential for analyzing sales trends and customer behavior over time.

      - name: ORDER_DESCRIPT
        description: >
          A brief description of the order, providing context for the order details. 
          This column is useful for understanding customer preferences and order patterns.

      - name: ORD_STATUS_CODE
        description: >
          The current status of the order, such as pending, shipped, or cancelled. 
          This column helps track order progress and identify potential issues.

      - name: AM_REQSTER_TYPE
        description: >
          The type of request associated with the order, such as a new order or a cancellation. 
          This column provides insight into customer behavior and order dynamics.

      - name: AGENCY_ID
        description: >
          The identifier for the agency associated with the order. 
          This column is useful for analyzing agency performance and order distribution.

      - name: AGENT_ID
        description: >
          The identifier for the agent associated with the order. 
          This column helps track agent performance and order allocation.

      - name: CLIENT_ID
        description: >
          The identifier for the client associated with the order. 
          This column is essential for understanding client behavior and order patterns.

      - name: AM_BOOKING_TYPE
        description: >
          The type of booking associated with the order, such as a direct booking or a cancellation. 
          This column provides insight into customer booking behavior and order dynamics.

      - name: RES_ID
        description: >
          The identifier for the resource associated with the order. 
          This column is useful for analyzing resource utilization and order allocation.

      - name: GROUP_ID
        description: >
          The identifier for the group associated with the order. 
          This column helps track group performance and order distribution.

      - name: DISPATCHED_DATE
        description: >
          The date on which the order was dispatched. 
          This column is essential for analyzing order fulfillment and shipping performance.

      - name: DISPATCHED_OK
        description: >
          A flag indicating whether the order was dispatched successfully. 
          This column helps track order fulfillment and identify potential issues.

      - name: GIFT_CARD_TO
        description: >
          The recipient of a gift card associated with the order. 
          This column is useful for understanding customer gifting behavior and order patterns.

      - name: GIFT_CARD_MSG
        description: >
          A message associated with a gift card order. 
          This column provides insight into customer sentiment and order context.

      - name: COMPLIMENTS_OF
        description: >
          A note indicating who the order is compliments of. 
          This column helps track customer relationships and order dynamics.

      - name: ORDER_VALID
        description: >
          A flag indicating whether the order is valid. 
          This column is essential for ensuring data quality and order integrity.

      - name: TERMINATION_COMPLETED
        description: >
          A flag indicating whether the order termination process has been completed. 
          This column helps track order fulfillment and identify potential issues.

      - name: CREATED_FROM_ADDON
        description: >
          A flag indicating whether the order was created from an add-on. 
          This column provides insight into customer behavior and order patterns.

      - name: CANCEL_REFUND_DONE
        description: >
          A flag indicating whether a cancellation refund has been processed. 
          This column helps track order fulfillment and identify potential issues.

      - name: FREE_OF_CHARGE
        description: >
          A flag indicating whether the order is free of charge. 
          This column is useful for understanding customer behavior and order dynamics.

      - name: GROUP_DISTRIBUTION_OK
        description: >
          A flag indicating whether group distribution has been completed successfully. 
          This column helps track order fulfillment and identify potential issues.

      - name: SHOW_ITEM_LIST
        description: >
          A flag indicating whether the item list should be displayed. 
          This column provides insight into customer preferences and order context.

      - name: CURRENCY_CODE
        description: >
          The currency code associated with the order. 
          This column is essential for analyzing sales trends and customer behavior across different currencies.

      - name: AM_ENTITY_TYPE
        description: >
          The type of entity associated with the order, such as a customer or an agency. 
          This column helps track entity performance and order distribution.

      - name: INVOICE_VALID
        description: >
          A flag indicating whether the invoice is valid. 
          This column is essential for ensuring data quality and order integrity.

      - name: FROM_COUPON
        description: >
          A flag indicating whether the order originated from a coupon. 
          This column provides insight into customer behavior and order patterns.

      - name: SOURCE_DELETED
        description: >
          A flag indicating whether the order has been deleted in the source system. 
          This column helps track data provenance and identify potential discrepancies between systems.

      - name: LAST_UPDATED_TIMESTAMP
        description: >
          The timestamp when the order was last updated. 
          This column is essential for analyzing order dynamics and identifying potential issues.