models:
  - name: vendor
    description: >
      The vendor model represents a unified view of vendors across multiple source systems, 
      including SW1 and SW2. Data from these systems may differ due to variations in data 
      collection, processing, and storage. This standardized model is used downstream for 
      reporting, analytics, and auditability, providing a single source of truth for vendor 
      information. Key analytical use cases include tracking vendor performance, monitoring 
      vendor compliance, and analyzing vendor spend.

    meta:
      owner: data_engineering
      criticality: high
      pii: false

    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - VENDOR_ID
            - DATA_SOURCE

    columns:
      - name: VENDOR_SURROGATE_KEY
        description: >
          A unique identifier for each vendor, generated by combining the VENDOR_ID and 
          DATA_SOURCE columns. This key ensures that each vendor is uniquely represented 
          across multiple source systems.

      - name: DATA_SOURCE
        description: >
          The source system from which the vendor data was extracted, either SW1 or SW2. 
          This column is used to track the origin of the data and ensure data integrity.

      - name: VENDOR_ID
        description: >
          A unique identifier for the vendor within the source system. This column, in 
          combination with the DATA_SOURCE column, forms the primary key for the vendor 
          model.
        tests:
          - not_null

      - name: VENDOR_CODE
        description: >
          A code assigned to the vendor, used for identification and tracking purposes.

      - name: VENDOR_NAME_TYPED
        description: >
          The name of the vendor, including any typing or classification information.

      - name: VENDOR_NAME
        description: >
          The name of the vendor, without any typing or classification information.

      - name: CONTACT
        description: >
          The contact information for the vendor, including phone numbers, addresses, or 
          other relevant details.

      - name: COMMENTS
        description: >
          Any additional comments or notes related to the vendor.

      - name: IS_ACTIVE
        description: >
          A flag indicating whether the vendor is currently active or inactive.

      - name: EMAIL
        description: >
          The email address associated with the vendor.

      - name: LAST_UPDATED_TIMESTAMP
        description: >
          The timestamp when the vendor data was last updated in the source system.

      - name: SOURCE_DELETED
        description: >
          A flag indicating whether the vendor has been deleted in the source system.