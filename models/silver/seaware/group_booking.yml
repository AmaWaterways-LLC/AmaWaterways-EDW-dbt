models:
- name: group_booking
  description: 'This model represents group bookings in the enterprise domain, combining
    data from multiple systems (SW1 and SW2).  The data from these systems may differ
    due to varying update frequencies, data entry practices, or system-specific rules.  This
    standardized model is used downstream for reporting, analytics, and auditing purposes,
    providing a unified view of group bookings.  Key analytical use cases include
    tracking booking trends, analyzing group demographics, and monitoring sales performance.

    '
  meta:
    owner: data_engineering
    criticality: high
    pii: false
  tests:
  - dbt_utils.unique_combination_of_columns:
      combination_of_columns:
      - GROUP_ID
      - DATA_SOURCE
      where: "SOURCE_DELETED = false"

  columns:
  - name: GROUP_BOOKING_SURROGATE_KEY
    description: 'A unique identifier for each group booking, generated by combining
      GROUP_ID and DATA_SOURCE.  This key ensures row uniqueness and facilitates joins
      with other models.

      '
  - name: DATA_SOURCE
    description: 'The source system of the group booking data (either SW1 or SW2).  This
      column is used to track data origin and manage potential discrepancies between
      systems.

      '
  - name: GROUP_ID
    description: 'A unique identifier for the group booking within its source system.  This
      column, combined with DATA_SOURCE, forms the primary key of this model.

      '
    tests:
    - not_null
  - name: COMMENTS
    description: 'Free-text comments associated with the group booking.  This column
      may contain relevant information for customer service or sales teams.

      '
  - name: AGENCY_ID
    description: 'The identifier of the agency responsible for the group booking.  This
      column is used to track agency performance and manage relationships.

      '
  - name: AGENT_ID
    description: 'The identifier of the agent who made the group booking.  This column
      is used to track agent performance and manage sales teams.

      '
  - name: GROUP_NAME
    description: 'The name of the group associated with the booking.  This column
      is used for reporting and customer service purposes.

      '
  - name: GROUP_TYPE
    description: 'The type of group (e.g., corporate, leisure, etc.).  This column
      is used for segmenting and analyzing group bookings.

      '
  - name: N_OF_GUESTS
    description: 'The number of guests in the group booking.  This column is used
      for capacity planning and revenue forecasting.

      '
  - name: REL_DAY_FROM
    description: 'The start date of the group booking, relative to the sailing date.  This
      column is used for scheduling and planning purposes.

      '
  - name: REL_DAY_TO
    description: 'The end date of the group booking, relative to the sailing date.  This
      column is used for scheduling and planning purposes.

      '
  - name: SAIL_DATE_FROM
    description: 'The start date of the sailing associated with the group booking.  This
      column is used for scheduling and planning purposes.

      '
  - name: SAIL_DATE_TO
    description: 'The end date of the sailing associated with the group booking.  This
      column is used for scheduling and planning purposes.

      '
  - name: SHIP_CODE
    description: 'The code of the ship associated with the group booking.  This column
      is used for operational and logistical purposes.

      '
  - name: IS_ACTIVE
    description: 'A flag indicating whether the group booking is active or not.  This
      column is used for filtering and reporting purposes.

      '
  - name: IS_VALID
    description: 'A flag indicating whether the group booking is valid or not.  This
      column is used for data quality and auditing purposes.

      '
  - name: PROBABILITY
    description: 'The probability of the group booking being confirmed.  This column
      is used for forecasting and revenue management purposes.

      '
  - name: GROUP_STATUS
    description: 'The status of the group booking (e.g., pending, confirmed, cancelled).  This
      column is used for tracking and reporting purposes.

      '
  - name: ALLOW_DIFF_AGENCY
    description: 'A flag indicating whether the group booking allows different agencies.  This
      column is used for managing agency relationships and sales teams.

      '
  - name: EXPIRATION_EXTENSION
    description: 'The number of days the group booking can be extended before expiration.  This
      column is used for managing booking lifecycles and revenue management.

      '
  - name: GROUP_INIT_DATE
    description: 'The date the group booking was initialized.  This column is used
      for tracking and reporting purposes.

      '
  - name: WDW_GROUP_ID
    description: 'The identifier of the group booking in the WDW system.  This column
      is used for integrating with other systems and managing data consistency.

      '
  - name: PRIORITY
    description: 'The priority level of the group booking.  This column is used for
      managing booking queues and customer service.

      '
  - name: TERMINATION_COMPLETED
    description: 'A flag indicating whether the group booking termination has been
      completed.  This column is used for managing booking lifecycles and revenue
      management.

      '
  - name: GROUP_SIZE_OVERRIDE
    description: 'The overridden group size for the booking.  This column is used
      for managing capacity and revenue forecasting.

      '
  - name: PROBABILITY_ALLOCATED
    description: 'The allocated probability for the group booking.  This column is
      used for forecasting and revenue management purposes.

      '
  - name: IS_CONTRACT_RATE
    description: 'A flag indicating whether the group booking has a contract rate.  This
      column is used for managing revenue and pricing strategies.

      '
  - name: CAN_PROCESS_GTB
    description: 'A flag indicating whether the group booking can be processed through
      GTB.  This column is used for managing booking workflows and revenue management.

      '
  - name: GRP_COORD_NAME
    description: 'The name of the group coordinator.  This column is used for customer
      service and sales purposes.

      '
  - name: USE_TC_FULLPAY
    description: 'A flag indicating whether to use the TC full pay option.  This column
      is used for managing payment workflows and revenue management.

      '
  - name: CURRENCY_CODE
    description: 'The currency code associated with the group booking.  This column
      is used for managing revenue and pricing strategies.

      '
  - name: SEC_AGENCY_ID
    description: 'The identifier of the secondary agency associated with the group
      booking.  This column is used for managing agency relationships and sales teams.

      '
  - name: LANGUAGE_CODE
    description: 'The language code associated with the group booking.  This column
      is used for customer service and sales purposes.

      '
  - name: IS_INVOICE_VALID
    description: 'A flag indicating whether the invoice is valid for the group booking.  This
      column is used for managing revenue and accounting workflows.

      '
  - name: IS_CHARTER
    description: 'A flag indicating whether the group booking is a charter.  This
      column is used for managing revenue and pricing strategies.

      '
  - name: OFFICE_CODE
    description: 'The office code associated with the group booking.  This column
      is used for operational and logistical purposes.

      '
  - name: IS_PROB_MANUAL
    description: 'A flag indicating whether the probability is manually set for the
      group booking.  This column is used for managing forecasting and revenue management
      workflows.

      '
  - name: ALLOW_UNBALANCE
    description: 'A flag indicating whether to allow unbalanced bookings for the group.  This
      column is used for managing revenue and pricing strategies.

      '
  - name: CURRENCY_RATE
    description: 'The currency rate associated with the group booking.  This column
      is used for managing revenue and pricing strategies.

      '
  - name: IS_UNBALANCED
    description: 'A flag indicating whether the group booking is unbalanced.  This
      column is used for managing revenue and pricing strategies.

      '
  - name: GB_ENTITY_TYPE
    description: 'The entity type of the group booking (e.g., individual, group).  This
      column is used for segmenting and analyzing group bookings.

      '
  - name: INVOICE_VERSION
    description: 'The version of the invoice associated with the group booking.  This
      column is used for managing revenue and accounting workflows.

      '
  - name: FIRST_FULL_PAYMENT_PROCESSED
    description: 'The date the first full payment was processed for the group booking.  This
      column is used for managing payment workflows and revenue management.

      '
  - name: ALLOW_AUTO_PROCESS_FPR
    description: 'A flag indicating whether to allow automatic processing of FPR for
      the group booking.  This column is used for managing payment workflows and revenue
      management.

      '
  - name: DEFAULT_INSURANCE
    description: 'The default insurance option for the group booking.  This column
      is used for managing revenue and pricing strategies.

      '
  - name: AM_ORDER_ID
    description: 'The identifier of the AM order associated with the group booking.  This
      column is used for managing order workflows and revenue management.

      '
  - name: FPR_IN_PROCESS
    description: 'A flag indicating whether the FPR is in process for the group booking.  This
      column is used for managing payment workflows and revenue management.

      '
  - name: COMPANY_ID
    description: 'The identifier of the company associated with the group booking.  This
      column is used for managing company relationships and sales teams.

      '
  - name: UPDATE_VERSION
    description: 'The version of the update associated with the group booking.  This
      column is used for managing data consistency and auditing purposes.

      '
  - name: DEP_REF_ID
    description: 'The identifier of the departure reference associated with the group
      booking.  This column is used for operational and logistical purposes.

      '
  - name: ARR_REF_ID
    description: 'The identifier of the arrival reference associated with the group
      booking.  This column is used for operational and logistical purposes.

      '
  - name: IS_PAYSCH_MANUAL
    description: 'A flag indicating whether the payment schedule is manual for the
      group booking.  This column is used for managing payment workflows and revenue
      management.

      '
  - name: SEC_AGENT_ID
    description: 'The identifier of the secondary agent associated with the group
      booking.  This column is used for managing agency relationships and sales teams.

      '
  - name: COMPANY_AGENT_ID
    description: 'The identifier of the company agent associated with the group booking.  This
      column is used for managing company relationships and sales teams.

      '
  - name: CLIENT_ID
    description: 'The identifier of the client associated with the group booking.  This
      column is used for managing client relationships and sales teams.

      '
  - name: VT_PACKAGE_ID
    description: 'The identifier of the VT package associated with the group booking.  This
      column is used for managing package workflows and revenue management.

      '
  - name: OWNERSHIP_CODE
    description: 'The ownership code associated with the group booking.  This column
      is used for managing revenue and pricing strategies.

      '
  - name: INVOICE_GEN_DEFERRED
    description: 'A flag indicating whether the invoice generation is deferred for
      the group booking.  This column is used for managing revenue and accounting
      workflows.

      '
  - name: VAC_DATE_FROM
    description: 'The start date of the vacation associated with the group booking.  This
      column is used for operational and logistical purposes.

      '
  - name: VAC_DATE_TO
    description: 'The end date of the vacation associated with the group booking.  This
      column is used for operational and logistical purposes.

      '
  - name: TERMS_CONFIRMED
    description: 'A flag indicating whether the terms are confirmed for the group
      booking.  This column is used for managing revenue and pricing strategies.

      '
  - name: SOURCE_CODE
    description: 'The source code associated with the group booking.  This column
      is used for managing revenue and pricing strategies.

      '
  - name: GROUP_MODE
    description: 'The group mode associated with the group booking (e.g., private,
      shared).  This column is used for segmenting and analyzing group bookings.

      '
  - name: ALLOW_INVOICING
    description: 'A flag indicating whether invoicing is allowed for the group booking.  This
      column is used for managing revenue and accounting workflows.

      '
  - name: INVENTORY_RELEASE_DATE
    description: 'The date the inventory is released for the group booking.  This
      column is used for operational and logistical purposes.

      '
  - name: USE_FIT_PAYSCH
    description: 'A flag indicating whether to use the FIT payment schedule for the
      group booking.  This column is used for managing payment workflows and revenue
      management.

      '
  - name: TC_SAIL_ID
    description: 'The identifier of the TC sail associated with the group booking.  This
      column is used for operational and logistical purposes.

      '
  - name: PROCESS_AS_WHOLE_ENTITY
    description: 'A flag indicating whether to process the group booking as a whole
      entity.  This column is used for managing revenue and pricing strategies.

      '
  - name: AUTO_DISTRIBUTE_MONEY
    description: 'A flag indicating whether to automatically distribute money for
      the group booking.  This column is used for managing payment workflows and revenue
      management.

      '
  - name: EXTRA_AGENCY_ID
    description: 'The identifier of the extra agency associated with the group booking.  This
      column is used for managing agency relationships and sales teams.

      '
  - name: TOUR_PACKAGE_ID
    description: 'The identifier of the tour package associated with the group booking.  This
      column is used for managing package workflows and revenue management.

      '
  - name: ALLOW_DIFF_CURR_RATE
    description: 'A flag indicating whether to allow different currency rates for
      the group booking.  This column is used for managing revenue and pricing strategies.

      '
  - name: DISTR_MONEY_TYPE
    description: 'The type of money distribution for the group booking (e.g., manual,
      automatic).  This column is used for managing payment workflows and revenue
      management.

      '
  - name: GROUP_GUID
    description: 'The GUID of the group associated with the group booking.  This column
      is used for managing group relationships and sales teams.

      '
  - name: QUOTE_CONFIRMATION_DATE
    description: 'The date the quote is confirmed for the group booking.  This column
      is used for managing revenue and pricing strategies.

      '
  - name: LAST_UPDATED_TIMESTAMP
    description: 'The timestamp of the last update for the group booking.  This column
      is used for managing data consistency and auditing purposes.

      '
  - name: SOURCE_DELETED
    description: 'A flag indicating whether the group booking is deleted in the source
      system.  This column is used for managing data consistency and auditing purposes.

      '
  - name: ALLOW_AUTO_DISTR_FUNDS
    description: 'A flag indicating whether to allow automatic distribution of funds
      for the group booking.  This column is used for managing payment workflows and
      revenue management.

      '
  - name: ALLOW_AUTO_CANCEL_DLGT
    description: 'A flag indicating whether to allow automatic cancellation of delegations
      for the group booking.  This column is used for managing revenue and pricing
      strategies.

      '
  - name: TOUR_CREDIT_POLICY_OVR
    description: 'The tour credit policy override for the group booking.  This column
      is used for managing revenue and pricing strategies.

      '
  - name: ALLOW_REFUND_CLIENT_MONEY
    description: A flag indicating whether to allow refunding client money for the
      group booking.  This column is used for managing payment workflows and revenue
      management.
