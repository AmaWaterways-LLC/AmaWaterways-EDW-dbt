models:
- name: res_invoice_canc
  description: 'This model represents cancelled invoices in the enterprise domain,
    combining data from multiple systems (SW1 and SW2).  The data from these systems
    may differ due to variations in data entry, processing, or timing.  This standardized
    model is used downstream for reporting, metrics, and auditability, providing a
    unified view of cancelled invoices.  Key analytical use cases include analyzing
    cancellation rates, identifying trends, and optimizing business processes.

    '
  meta:
    owner: data_engineering
    criticality: high
    pii: false
  tests:
  - dbt_utils.unique_combination_of_columns:
      combination_of_columns:
      - RES_INVOICE_ITEM_ID
      - DATA_SOURCE
      where: "SOURCE_DELETED = false"

  columns:
  - name: RES_INVOICE_CANC_SURROGATE_KEY
    description: 'A unique identifier for each cancelled invoice, generated by combining
      RES_INVOICE_ITEM_ID and DATA_SOURCE.  This surrogate key ensures row uniqueness
      and facilitates data integration.

      '
  - name: DATA_SOURCE
    description: 'The source system of the cancelled invoice data (either SW1 or SW2).  This
      column is used to track data origin and facilitate data quality analysis.

      '
  - name: RES_INVOICE_ITEM_ID
    description: 'A unique identifier for the invoice item in the source system.  This
      column is used in combination with DATA_SOURCE to create the surrogate key.

      '
    tests:
    - not_null
  - name: RES_ID
    description: 'The identifier of the associated reservation.  This column is used
      for data integration and analysis of reservation-related metrics.

      '
  - name: GUEST_ID
    description: 'The identifier of the guest associated with the cancelled invoice.  This
      column is used for data integration and analysis of guest-related metrics.

      '
  - name: RES_PACKAGE_ID
    description: 'The identifier of the package associated with the cancelled invoice.  This
      column is used for data integration and analysis of package-related metrics.

      '
  - name: INVOICE_ITEM_TYPE
    description: 'The type of invoice item (e.g., room, service, etc.).  This column
      is used for categorization and analysis of invoice items.

      '
  - name: INVOICE_ITEM_SUBTYPE
    description: 'The subtype of invoice item (e.g., room type, service type, etc.).  This
      column is used for further categorization and analysis of invoice items.

      '
  - name: PRICE_PER_UNIT
    description: 'The price per unit of the invoice item.  This column is used for
      calculating total costs and revenue.

      '
  - name: N_OF_UNITS
    description: 'The number of units of the invoice item.  This column is used for
      calculating total costs and revenue.

      '
  - name: PERCENT
    description: 'The percentage value associated with the invoice item (e.g., discount,
      tax, etc.).  This column is used for calculating total costs and revenue.

      '
  - name: AMOUNT
    description: 'The total amount of the invoice item.  This column is used for calculating
      total costs and revenue.

      '
  - name: INVOICE_ITEM_SUBTYPE2
    description: 'Additional subtype information for the invoice item.  This column
      is used for further categorization and analysis of invoice items.

      '
  - name: INVOICE_ITEM_SUBTYPE3
    description: 'Additional subtype information for the invoice item.  This column
      is used for further categorization and analysis of invoice items.

      '
  - name: PRICE_PROGRAM
    description: 'The price program associated with the invoice item.  This column
      is used for data integration and analysis of pricing strategies.

      '
  - name: HOTEL_REQUEST_ID
    description: 'The identifier of the hotel request associated with the cancelled
      invoice.  This column is used for data integration and analysis of hotel request-related
      metrics.

      '
  - name: COMMISSION_PERCENT
    description: 'The commission percentage associated with the invoice item.  This
      column is used for calculating total costs and revenue.

      '
  - name: PRICE_AREA
    description: 'The price area associated with the invoice item (e.g., room, service,
      etc.).  This column is used for categorization and analysis of invoice items.

      '
  - name: EXTENDED_INFO
    description: 'Additional information about the invoice item.  This column is used
      for data integration and analysis of invoice item details.

      '
  - name: ADJUSTMENT_ORIGIN
    description: 'The origin of the adjustment associated with the invoice item.  This
      column is used for data integration and analysis of adjustment-related metrics.

      '
  - name: RES_PRODUCT_ID
    description: 'The identifier of the product associated with the cancelled invoice.  This
      column is used for data integration and analysis of product-related metrics.

      '
  - name: CLIENT_ID
    description: 'The identifier of the client associated with the cancelled invoice.  This
      column is used for data integration and analysis of client-related metrics.

      '
  - name: GUEST_SEQN
    description: 'The sequence number of the guest associated with the cancelled invoice.  This
      column is used for data integration and analysis of guest-related metrics.

      '
  - name: POINTS_BALANCE_ID
    description: 'The identifier of the points balance associated with the cancelled
      invoice.  This column is used for data integration and analysis of points balance-related
      metrics.

      '
  - name: LAST_UPDATED_TIMESTAMP
    description: 'The timestamp of the last update to the cancelled invoice data.  This
      column is used for data integration and analysis of data freshness.

      '
  - name: SOURCE_DELETED
    description: A flag indicating whether the cancelled invoice data was deleted
      in the source system.  This column is used for data integration and analysis
      of data consistency.
