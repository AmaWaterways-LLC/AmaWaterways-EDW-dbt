models:
  - name: res_room_request
    description: >
      This model represents a standardized view of room requests across multiple systems, 
      allowing for easier analysis and reporting of hotel room allocation and utilization. 
      Data from different systems may differ due to varying update frequencies or data entry practices. 
      This model is used downstream to analyze room request trends, track occupancy rates, and audit changes to room requests.

    meta:
      owner: data_engineering
      criticality: high
      pii: false

    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - RES_ID
            - ROOM_SEQ_NUMBER
            - DATA_SOURCE

    columns:
      - name: RES_ROOM_REQUEST_SURROGATE_KEY
        description: >
          A unique identifier for each room request, generated by combining RES_ID, ROOM_SEQ_NUMBER, and DATA_SOURCE.
          This key ensures that each room request is uniquely represented across different data sources.

      - name: DATA_SOURCE
        description: >
          The source system from which the room request data was obtained.
          This column is used to track the origin of the data and to identify any discrepancies between systems.

      - name: ROOM_REQUEST_ID
        description: >
          A unique identifier for the room request within the source system.
          This column is used to track changes to the room request over time.

      - name: RES_ID
        description: >
          A unique identifier for the reservation associated with the room request.
          This column is used to link the room request to the corresponding reservation.

      - name: ROOM_SEQ_NUMBER
        description: >
          A sequence number that uniquely identifies the room request within the reservation.
          This column is used in conjunction with RES_ID to uniquely identify the room request.

      - name: EFFECTIVE_DATE
        description: >
          The date on which the room request becomes effective.
          This column is used to track changes to the room request over time.

      - name: DATE_FROM
        description: >
          The start date of the room request.
          This column is used to determine the duration of the room request.

      - name: DATE_TO
        description: >
          The end date of the room request.
          This column is used to determine the duration of the room request.

      - name: HOTEL_CATEGORY
        description: >
          The category of the hotel associated with the room request.
          This column is used to analyze room request trends by hotel category.

      - name: HOTEL_ROOM_CATEGORY
        description: >
          The category of the hotel room associated with the room request.
          This column is used to analyze room request trends by hotel room category.

      - name: HOTEL_ID
        description: >
          A unique identifier for the hotel associated with the room request.
          This column is used to link the room request to the corresponding hotel.

      - name: HOTEL_ROOM_TYPE
        description: >
          The type of hotel room associated with the room request.
          This column is used to analyze room request trends by hotel room type.

      - name: OCCUPANCY
        description: >
          The number of guests occupying the room.
          This column is used to track occupancy rates and analyze room request trends.

      - name: CITY_CODE
        description: >
          The city code associated with the hotel.
          This column is used to analyze room request trends by city.

      - name: IS_INDEPENDENT
        description: >
          A flag indicating whether the room request is independent or not.
          This column is used to analyze room request trends by independence.

      - name: EXTRA_ROOM_MODE
        description: >
          The mode of the extra room associated with the room request.
          This column is used to analyze room request trends by extra room mode.

      - name: COMMENTS
        description: >
          Any additional comments associated with the room request.
          This column is used to track any additional information related to the room request.

      - name: CHANGED_MANUALLY
        description: >
          A flag indicating whether the room request was changed manually or not.
          This column is used to track changes to the room request.

      - name: HOTEL_BED_TYPE
        description: >
          The type of bed associated with the hotel room.
          This column is used to analyze room request trends by hotel bed type.

      - name: REQUEST_STATUS
        description: >
          The status of the room request.
          This column is used to track the status of the room request.

      - name: LAST_UPDATED_TIMESTAMP
        description: >
          The timestamp when the room request was last updated.
          This column is used to track changes to the room request over time.

      - name: SOURCE_DELETED
        description: >
          A flag indicating whether the room request was deleted in the source system or not.
          This column is used to track deletions to the room request.

      - name: RES_ID
        tests:
          - not_null

      - name: ROOM_SEQ_NUMBER
        tests:
          - not_null

      - name: DATA_SOURCE
        tests:
          - not_null