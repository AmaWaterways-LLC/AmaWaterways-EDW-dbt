models:
  - name: res_event
    description: >
      The res_event model represents a standardized view of resource events across multiple systems, including SW1 and SW2. 
      Data from these systems may differ due to differences in data collection, processing, or timing. 
      This model is used downstream to provide a unified understanding of resource events, enabling reporting, metrics, and auditability. 
      Key analytical use cases include analyzing event types, operator activities, and status changes.

    meta:
      owner: data_engineering
      criticality: high
      pii: false

    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - RECORD_ID
            - DATA_SOURCE

    columns:
      - name: RES_EVENT_SURROGATE_KEY
        description: >
          A unique identifier for each resource event, generated by combining RECORD_ID and DATA_SOURCE. 
          This column ensures row uniqueness and facilitates data integration.

      - name: DATA_SOURCE
        description: >
          The source system of the resource event, either SW1 or SW2. 
          This column is used to track data origin and enable system-specific analysis.

        tests:
          - not_null

      - name: RECORD_ID
        description: >
          A unique identifier for the resource event within its source system. 
          This column, combined with DATA_SOURCE, ensures row uniqueness.

        tests:
          - not_null

      - name: RES_EVENT_TYPE
        description: >
          The type of resource event, such as creation, update, or deletion. 
          This column is used to analyze event patterns and trends.

      - name: RES_ID
        description: >
          The identifier of the resource associated with the event. 
          This column enables analysis of resource-specific events and activities.

      - name: EVENT_TIMESTAMP
        description: >
          The timestamp of the resource event. 
          This column is used to analyze event timing and sequencing.

      - name: OPERATOR_ID
        description: >
          The identifier of the operator who triggered the resource event. 
          This column enables analysis of operator activities and event responsibility.

      - name: OLD_STATUS
        description: >
          The previous status of the resource before the event. 
          This column is used to analyze status changes and event impact.

      - name: NEW_STATUS
        description: >
          The new status of the resource after the event. 
          This column is used to analyze status changes and event impact.

      - name: OLD_SHIP_CODE
        description: >
          The previous ship code associated with the resource before the event. 
          This column is used to analyze changes in ship codes and event impact.

      - name: OLD_SAIL_FROM
        description: >
          The previous sail-from date associated with the resource before the event. 
          This column is used to analyze changes in sail dates and event impact.

      - name: OLD_SAIL_TO
        description: >
          The previous sail-to date associated with the resource before the event. 
          This column is used to analyze changes in sail dates and event impact.

      - name: NEW_SHIP_CODE
        description: >
          The new ship code associated with the resource after the event. 
          This column is used to analyze changes in ship codes and event impact.

      - name: NEW_SAIL_FROM
        description: >
          The new sail-from date associated with the resource after the event. 
          This column is used to analyze changes in sail dates and event impact.

      - name: NEW_SAIL_TO
        description: >
          The new sail-to date associated with the resource after the event. 
          This column is used to analyze changes in sail dates and event impact.

      - name: LAST_UPDATED_TIMESTAMP
        description: >
          The timestamp of the last update to the resource event. 
          This column is used to track data freshness and event timing.

      - name: SOURCE_DELETED
        description: >
          A flag indicating whether the resource event was deleted in the source system. 
          This column is used to track data deletion and event history.