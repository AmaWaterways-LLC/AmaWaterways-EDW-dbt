models:
- name: airport
  description: 'The airport model represents a standardized view of airport data from
    multiple source systems, SW1 and SW2.  Data from these systems may differ due
    to variations in data collection methods, data freshness, and system-specific
    nuances.  This model is used downstream for reporting, analytics, and data science
    applications, providing a unified view of airport information.  Key analytical
    use cases include analyzing airport traffic, tracking changes in airport status,
    and auditing data quality.

    '
  meta:
    owner: data_engineering
    criticality: high
    pii: false
  tests:
  - dbt_utils.unique_combination_of_columns:
      combination_of_columns:
      - AIRPORT_CODE
      - DATA_SOURCE
      

  columns:
  - name: AIRPORT_SURROGATE_KEY
    description: 'A unique identifier for each airport, generated by combining the
      airport code and data source.  This key ensures that each airport is uniquely
      represented across different source systems.

      '
  - name: DATA_SOURCE
    description: 'The source system from which the airport data originates, either
      SW1 or SW2.  This column is used to track data provenance and identify potential
      discrepancies between sources.

      '
  - name: AIRPORT_ID
    description: 'A numeric identifier for the airport, as represented in the source
      system.  This column may be used for joining with other tables or for tracking
      changes in airport information.

      '
  - name: AIRPORT_CODE
    description: 'A standardized code for the airport, used for identification and
      analysis.  This column is part of the primary key, ensuring that each airport
      code is unique within a given data source.

      '
    tests:
    - not_null
  - name: AIRPORT_NAME_TYPED
    description: 'The full name of the airport, including any additional typing or
      classification information.  This column is used for reporting and analytics,
      providing a human-readable description of the airport.

      '
  - name: AIRPORT_NAME
    description: 'The standard name of the airport, without any additional typing
      or classification information.  This column is used for reporting and analytics,
      providing a concise description of the airport.

      '
  - name: STATE_CODE
    description: 'The state or region in which the airport is located, represented
      as a standardized code.  This column is used for geographic analysis and reporting.

      '
  - name: COUNTRY_CODE
    description: 'The country in which the airport is located, represented as a standardized
      code.  This column is used for geographic analysis and reporting.

      '
  - name: IS_ACTIVE
    description: 'A flag indicating whether the airport is currently active or inactive.  This
      column is used for reporting and analytics, providing insight into airport status.

      '
  - name: COMMENTS
    description: 'Additional comments or notes about the airport, as provided by the
      source system.  This column is used for auditing and data quality analysis.

      '
  - name: ACTIVE_CNG_TIMESTAMP
    description: 'The timestamp at which the airport''s active status was last changed.  This
      column is used for tracking changes in airport status over time.

      '
  - name: LAST_UPDATED_TIMESTAMP
    description: 'The timestamp at which the airport data was last updated in the
      source system.  This column is used for auditing and data quality analysis.

      '
  - name: SOURCE_DELETED
    description: A flag indicating whether the airport data has been deleted in the
      source system.  This column is used for auditing and data quality analysis.
