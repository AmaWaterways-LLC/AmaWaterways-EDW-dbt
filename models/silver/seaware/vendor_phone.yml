models:
  - name: vendor_phone
    description: >
      This model represents a standardized view of vendor phone information, 
      combining data from multiple source systems (SW1 and SW2). 
      The data may differ between systems due to variations in data entry, 
      formatting, or update frequencies. 
      This model is used downstream for reporting, analytics, and data quality audits. 
      Key analytical use cases include tracking vendor communication channels, 
      identifying data discrepancies, and monitoring data completeness.

    meta:
      owner: data_engineering
      criticality: high
      pii: false

    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - SEQ_NUMBER
            - VENDOR_ID
            - DATA_SOURCE

    columns:
      - name: VENDOR_PHONE_SURROGATE_KEY
        description: >
          A unique identifier for each vendor phone record, 
          generated by combining SEQ_NUMBER, VENDOR_ID, and DATA_SOURCE. 
          This key ensures row uniqueness and facilitates data integration.

      - name: DATA_SOURCE
        description: >
          The source system from which the vendor phone data originated, 
          either SW1 or SW2. This column is used to track data provenance.

      - name: SEQ_NUMBER
        description: >
          A sequence number assigned to each vendor phone record, 
          used to maintain data ordering and uniqueness. 
          This column is part of the primary key.

        tests:
          - not_null

      - name: PHONE_TYPE
        description: >
          The type of phone number, such as primary, secondary, or fax. 
          This column is used to categorize vendor phone numbers.

      - name: INTL_CODE
        description: >
          The international code associated with the phone number, 
          used to facilitate global communication.

      - name: PHONE_NUMBER
        description: >
          The actual phone number, which may include formatting variations. 
          This column is used for reporting and analytics.

      - name: IS_PHONE_PRIMARY
        description: >
          A flag indicating whether the phone number is primary, 
          used to identify the primary contact method.

      - name: IS_PHONE_SECONDARY
        description: >
          A flag indicating whether the phone number is secondary, 
          used to identify alternative contact methods.

      - name: IS_PHONE_FAX
        description: >
          A flag indicating whether the phone number is a fax number, 
          used to identify fax communication channels.

      - name: FAX_ATTENTION_LINE
        description: >
          The attention line associated with the fax number, 
          used to provide additional context.

      - name: COMMENTS
        description: >
          Free-form comments related to the vendor phone record, 
          used to capture additional information.

      - name: VENDOR_ID
        description: >
          The identifier for the vendor associated with the phone record, 
          used to link vendor information. 
          This column is part of the primary key.

        tests:
          - not_null

      - name: VENDOR_PHONE_ID
        description: >
          The identifier for the vendor phone record, 
          used to track record-level information.

      - name: PHONE_EXT
        description: >
          The phone extension associated with the phone number, 
          used to provide additional contact information.

      - name: COUNTRY_CODE
        description: >
          The country code associated with the phone number, 
          used to facilitate global communication.

      - name: LAST_UPDATED_TIMESTAMP
        description: >
          The timestamp when the vendor phone record was last updated, 
          used to track data freshness and changes.

      - name: SOURCE_DELETED
        description: >
          A flag indicating whether the record was deleted in the source system, 
          used to track data lineage and changes.