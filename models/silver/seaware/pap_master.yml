models:
  - name: pap_master
    description: >
      The PAP Master model represents a centralized repository of Program, Agency, and Partner (PAP) data from multiple source systems, including SW1 and SW2. This model standardizes PAP data to facilitate downstream analytics, reporting, and auditability. The data from multiple systems may differ due to variations in data formatting, collection methods, or update frequencies. This model is used to generate reports on PAP performance, track program currency, and analyze agency domestic data.

    meta:
      owner: data_engineering
      criticality: high
      pii: false

    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - PAP_CODE
            - DATA_SOURCE

    columns:
      - name: PAP_MASTER_SURROGATE_KEY
        description: >
          A unique surrogate key generated by combining PAP_CODE and DATA_SOURCE. This key ensures row uniqueness and facilitates efficient data retrieval.
        tests:
          - not_null

      - name: DATA_SOURCE
        description: >
          The source system from which the PAP data originated, either SW1 or SW2. This column is used to track data lineage and identify potential discrepancies between source systems.

      - name: PAP_CODE
        description: >
          A unique identifier for the Program, Agency, or Partner. This column is used to track PAP performance and is a key component of the surrogate key.
        tests:
          - not_null

      - name: PAP_ID
        description: >
          A numeric identifier for the PAP. This column is used for analytical purposes and may be used to join with other tables.

      - name: PRIORITY
        description: >
          The priority level assigned to the PAP. This column is used to determine the order in which PAPs are processed or analyzed.

      - name: PROGRAM_CURRENCY
        description: >
          The currency used by the program. This column is used to track financial data and may be used for currency conversion purposes.

      - name: AGENCY_DOMESTIC
        description: >
          A flag indicating whether the agency is domestic or international. This column is used to analyze agency performance and may be used for reporting purposes.

      - name: PAP_TYPE
        description: >
          The type of PAP, such as program, agency, or partner. This column is used to categorize PAPs and may be used for analytical purposes.

      - name: COMMENTS
        description: >
          Free-form comments related to the PAP. This column is used to store additional information about the PAP.

      - name: PAP_NAME
        description: >
          The name of the PAP. This column is used to identify the PAP and may be used for reporting purposes.

      - name: EXTERNAL_RULES
        description: >
          External rules or regulations applicable to the PAP. This column is used to track compliance and may be used for audit purposes.

      - name: IS_PRICE_PROGRAM
        description: >
          A flag indicating whether the program is a price program. This column is used to determine pricing rules and may be used for analytical purposes.

      - name: PROMO_GROUP
        description: >
          The promotional group associated with the PAP. This column is used to track marketing efforts and may be used for analytical purposes.

      - name: COUPON_CLASS
        description: >
          The coupon class associated with the PAP. This column is used to track coupon usage and may be used for analytical purposes.

      - name: PRINT_CRUISE_FARE_AMOUNT
        description: >
          The print cruise fare amount associated with the PAP. This column is used to track financial data and may be used for analytical purposes.

      - name: SOURCE_DELETED
        description: >
          A flag indicating whether the PAP has been deleted in the source system. This column is used to track data lineage and may be used for audit purposes.

      - name: LAST_UPDATED_TIMESTAMP
        description: >
          The timestamp when the PAP data was last updated. This column is used to track data freshness and may be used for analytical purposes.