models:
- name: hotel_phone
  description: 'The hotel_phone model represents a standardized view of hotel phone
    data from multiple source systems, SW1 and SW2.  Data from these systems may differ
    due to variations in data collection, processing, or storage.  This model is used
    downstream to provide a unified view of hotel phone data for reporting, analytics,
    and auditability.  Key analytical use cases include tracking hotel phone usage,
    analyzing phone type distribution, and monitoring data quality.

    '
  meta:
    owner: data_engineering
    criticality: high
    pii: false
  tests:
  - dbt_utils.unique_combination_of_columns:
      combination_of_columns:
      - HOTEL_ID
      - SEQ_NUMBER
      - DATA_SOURCE
      

  columns:
  - name: HOTEL_PHONE_SURROGATE_KEY
    description: 'A unique identifier for each hotel phone record, generated by combining
      HOTEL_ID, SEQ_NUMBER, and DATA_SOURCE.  This key ensures row uniqueness and
      facilitates data integration and analysis.

      '
  - name: DATA_SOURCE
    description: 'The source system from which the hotel phone data originated, either
      SW1 or SW2.  This column is used to track data provenance and manage data quality.

      '
  - name: SEQ_NUMBER
    description: 'A sequence number assigned to each hotel phone record, used to maintain
      data ordering and uniqueness.  This column is part of the primary key.

      '
    tests:
    - not_null
  - name: PHONE_TYPE
    description: 'The type of phone, such as primary, secondary, or fax.  This column
      is used to analyze phone type distribution and usage.

      '
  - name: INTL_CODE
    description: 'The international code associated with the phone number.  This column
      is used to facilitate global communication and analysis.

      '
  - name: PHONE_NUMBER
    description: 'The actual phone number, which may include country codes, area codes,
      and local numbers.  This column is used to analyze phone usage and communication
      patterns.

      '
  - name: IS_PHONE_PRIMARY
    description: 'A flag indicating whether the phone is primary or not.  This column
      is used to analyze primary phone usage and distribution.

      '
  - name: IS_PHONE_SECONDARY
    description: 'A flag indicating whether the phone is secondary or not.  This column
      is used to analyze secondary phone usage and distribution.

      '
  - name: IS_PHONE_FAX
    description: 'A flag indicating whether the phone is a fax or not.  This column
      is used to analyze fax usage and distribution.

      '
  - name: FAX_ATTENTION_LINE
    description: 'The attention line associated with the fax, if applicable.  This
      column is used to facilitate fax communication and analysis.

      '
  - name: COMMENTS
    description: 'Additional comments or notes related to the hotel phone record.  This
      column is used to capture supplementary information and context.

      '
  - name: HOTEL_ID
    description: 'The unique identifier for the hotel associated with the phone record.  This
      column is part of the primary key and is used to link hotel phone data to hotel
      information.

      '
    tests:
    - not_null
  - name: HOTEL_PHONE_ID
    description: 'The unique identifier for the hotel phone record.  This column is
      used to track and analyze hotel phone data.

      '
  - name: PHONE_EXT
    description: 'The phone extension associated with the phone number, if applicable.  This
      column is used to facilitate phone communication and analysis.

      '
  - name: COUNTRY_CODE
    description: 'The country code associated with the phone number, if applicable.  This
      column is used to facilitate global communication and analysis.

      '
  - name: LAST_UPDATED_TIMESTAMP
    description: 'The timestamp when the hotel phone record was last updated.  This
      column is used to track data freshness and manage data quality.

      '
  - name: SOURCE_DELETED
    description: A flag indicating whether the hotel phone record was deleted in the
      source system.  This column is used to manage data quality and track data lineage.
