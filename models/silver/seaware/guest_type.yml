models:
- name: guest_type
  description: 'The guest_type model represents a standardized view of guest types
    across multiple systems,  including SW1 and SW2. This model is used to provide
    a unified understanding of guest types,  enabling downstream analytics and reporting.
    The data from multiple systems may differ due to  variations in data entry, formatting,
    or system-specific nuances. This model is critical for  generating reports, metrics,
    and audits related to guest types.

    '
  meta:
    owner: data_engineering
    criticality: high
    pii: false
  tests:
  - dbt_utils.unique_combination_of_columns:
      combination_of_columns:
      - GUEST_TYPE
      - DATA_SOURCE
      

  columns:
  - name: GUEST_TYPE_SURROGATE_KEY
    description: 'A unique identifier for each guest type, generated by combining
      the GUEST_TYPE and DATA_SOURCE columns. This key ensures that each guest type
      is uniquely represented across multiple systems.

      '
  - name: DATA_SOURCE
    description: 'The source system from which the guest type data originates, either
      SW1 or SW2. This column is used to track the origin of the data and enable system-specific
      analysis.

      '
    tests:
    - not_null
  - name: GUEST_TYPE
    description: 'The type of guest, as defined by the source system. This column
      is used to categorize guests and enable type-specific analysis.

      '
    tests:
    - not_null
  - name: GUEST_TYPE_ID
    description: 'A numeric identifier for the guest type, as defined by the source
      system. This column is used to provide a numeric reference for the guest type.

      '
  - name: COMMENTS
    description: 'Additional comments or notes related to the guest type. This column
      is used to capture any additional context or information about the guest type.

      '
  - name: IS_RESTRICTED
    description: 'A flag indicating whether the guest type is restricted or not. This
      column is used to identify guest types with restrictions or limitations.

      '
  - name: APPLY_CANC_PENALTIES
    description: 'A flag indicating whether cancellation penalties apply to the guest
      type. This column is used to determine whether cancellation penalties are applicable.

      '
  - name: FARE_TYPE_CODE
    description: 'A code representing the fare type associated with the guest type.
      This column is used to link the guest type to a specific fare type.

      '
  - name: ALLOW_GTB_MASSRUN
    description: 'A flag indicating whether the guest type allows GTB mass runs. This
      column is used to determine whether GTB mass runs are permitted.

      '
  - name: LAST_UPDATED_TIMESTAMP
    description: 'The timestamp when the guest type data was last updated. This column
      is used to track changes to the guest type data over time.

      '
  - name: SOURCE_DELETED
    description: A flag indicating whether the guest type has been deleted in the
      source system. This column is used to track deleted guest types and enable data
      recovery.
