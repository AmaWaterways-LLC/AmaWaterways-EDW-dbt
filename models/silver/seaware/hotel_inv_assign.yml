models:
- name: hotel_inv_assign
  description: 'The hotel_inv_assign model represents the assignment of hotel inventory
    to specific allocations and records,  sourced from multiple systems (SW1 and SW2).
    Data from these systems may differ due to varying update frequencies  or data
    entry practices. This standardized model is used downstream for reporting, metrics,
    and auditability,  providing a unified view of hotel inventory assignments. Key
    analytical use cases include tracking inventory  allocation, identifying discrepancies
    between systems, and monitoring data freshness.

    '
  meta:
    owner: data_engineering
    criticality: high
    pii: false
  tests:
  - dbt_utils.unique_combination_of_columns:
      combination_of_columns:
      - ALLOCATION_ID
      - INV_RECORD_ID
      - DATA_SOURCE
      where: "SOURCE_DELETED = false"

  columns:
  - name: HOTEL_INV_ASSIGN_SURROGATE_KEY
    description: 'A unique identifier for each hotel inventory assignment, generated
      by combining ALLOCATION_ID, INV_RECORD_ID,  and DATA_SOURCE. This surrogate
      key ensures row uniqueness and facilitates efficient data retrieval.

      '
  - name: DATA_SOURCE
    description: 'The source system of the hotel inventory assignment record, either
      SW1 or SW2. This column allows for  tracking and analysis of data discrepancies
      between the two systems.

      '
  - name: ALLOCATION_ID
    description: 'A unique identifier for the allocation associated with the hotel
      inventory assignment. This column plays a  crucial role in row uniqueness and
      is used in conjunction with INV_RECORD_ID and DATA_SOURCE to generate  the surrogate
      key.

      '
    tests:
    - not_null
  - name: INV_RECORD_ID
    description: 'A unique identifier for the inventory record associated with the
      hotel inventory assignment. This column,  along with ALLOCATION_ID and DATA_SOURCE,
      ensures row uniqueness and is used to generate the surrogate key.

      '
    tests:
    - not_null
  - name: HOTEL_CONF_NUMBER
    description: 'The hotel confirmation number associated with the inventory assignment.
      This column provides additional  context for analysis and reporting.

      '
  - name: LAST_UPDATED_TIMESTAMP
    description: 'The timestamp of the last update to the hotel inventory assignment
      record. This column is used to track  data freshness and monitor changes to
      the data.

      '
  - name: SOURCE_DELETED
    description: A flag indicating whether the hotel inventory assignment record has
      been deleted in the source system.  This column allows for tracking and analysis
      of deleted records.
