models:
  - name: group_commission_detail
    description: >
      This model represents a standardized view of group commission details from multiple systems, SW1 and SW2. 
      The data from these systems may differ due to variations in data collection, processing, or timing. 
      This model is used downstream for reporting, analytics, and auditability, providing a unified understanding of group commission details across the enterprise. 
      Key analytical use cases include tracking commission amounts, percentages, and sources, as well as identifying manual adjustments and payout dates.

    meta:
      owner: data_engineering
      criticality: high
      pii: false

    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - RECORD_ID
            - DATA_SOURCE

    columns:
      - name: GROUP_COMMISSION_DETAIL_SURROGATE_KEY
        description: >
          A unique identifier for each group commission detail record, generated by combining RECORD_ID and DATA_SOURCE. 
          This key ensures row uniqueness and facilitates data integration and analysis.

      - name: DATA_SOURCE
        description: >
          The source system of the group commission detail record, either SW1 or SW2. 
          This column allows for data lineage and auditing.

        tests:
          - not_null

      - name: RECORD_ID
        description: >
          A unique identifier for the group commission detail record within its source system. 
          This column, combined with DATA_SOURCE, ensures row uniqueness.

        tests:
          - not_null

      - name: AMOUNT
        description: >
          The commission amount associated with the group commission detail record. 
          This column is used for financial analysis and reporting.

      - name: COMMISS_FARE
        description: >
          The commission fare associated with the group commission detail record. 
          This column is used for financial analysis and reporting.

      - name: COMMISS_CODE
        description: >
          The commission code associated with the group commission detail record. 
          This column is used for categorization and analysis.

      - name: COMMISS_SOURCE
        description: >
          The source of the commission associated with the group commission detail record. 
          This column is used for data lineage and auditing.

      - name: INVOICE_ITEM_TYPE
        description: >
          The type of invoice item associated with the group commission detail record. 
          This column is used for categorization and analysis.

      - name: PERCENT
        description: >
          The commission percentage associated with the group commission detail record. 
          This column is used for financial analysis and reporting.

      - name: GROUP_ID
        description: >
          The group identifier associated with the group commission detail record. 
          This column is used for data integration and analysis.

      - name: PACKAGE_ID
        description: >
          The package identifier associated with the group commission detail record. 
          This column is used for data integration and analysis.

      - name: IS_MANUAL_ADJUSTMENT
        description: >
          A flag indicating whether the group commission detail record is a manual adjustment. 
          This column is used for data auditing and analysis.

      - name: AGENCY_ID
        description: >
          The agency identifier associated with the group commission detail record, applicable only to SW2 data. 
          This column is used for data integration and analysis.

      - name: PAYOUT_DATE
        description: >
          The payout date associated with the group commission detail record, applicable only to SW2 data. 
          This column is used for financial analysis and reporting.

      - name: GL_PROTOTYPE_ID
        description: >
          The general ledger prototype identifier associated with the group commission detail record, applicable only to SW2 data. 
          This column is used for financial analysis and reporting.

      - name: LAST_UPDATED_TIMESTAMP
        description: >
          The timestamp of the last update to the group commission detail record. 
          This column is used for data auditing and analysis.

      - name: SOURCE_DELETED
        description: >
          A flag indicating whether the group commission detail record has been deleted in the source system. 
          This column is used for data auditing and analysis.