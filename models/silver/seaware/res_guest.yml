models:
- name: res_guest
  description: 'The res_guest model represents a unified view of guest information
    from multiple source systems, SW1 and SW2.  Data from these systems may differ
    due to varying data collection methods and update frequencies.  This standardized
    model is used downstream for reporting, analytics, and auditing purposes, providing
    a single source of truth for guest data.  Key analytical use cases include tracking
    guest demographics, analyzing occupancy trends, and monitoring data quality.

    '
  meta:
    owner: data_engineering
    criticality: high
    pii: false
  tests:
  - dbt_utils.unique_combination_of_columns:
      combination_of_columns:
      - GUEST_ID
      - DATA_SOURCE
      where: "SOURCE_DELETED = false"

  columns:
  - name: RES_GUEST_SURROGATE_KEY
    description: 'A unique identifier for each guest record, generated by combining
      GUEST_ID and DATA_SOURCE.  This key ensures row uniqueness across multiple source
      systems.

      '
  - name: DATA_SOURCE
    description: 'The source system from which the guest data originated, either SW1
      or SW2.  This column is used to track data provenance and identify potential
      discrepancies between sources.

      '
  - name: GUEST_ID
    description: 'A unique identifier for the guest within the source system.  This
      column, combined with DATA_SOURCE, forms the primary key for the res_guest model.

      '
    tests:
    - not_null
  - name: GUEST_SEQN
    description: 'A sequence number associated with the guest, potentially used for
      ordering or grouping purposes.

      '
  - name: OCCUPANCY_NUMBER
    description: 'The occupancy number related to the guest, which may be used to
      track room assignments or capacity.

      '
  - name: RES_ID
    description: 'A reservation identifier linked to the guest, used to connect guest
      data to reservation information.

      '
  - name: CLIENT_ID
    description: 'A client identifier associated with the guest, potentially used
      for billing or customer relationship management.

      '
  - name: GUEST_TYPE
    description: 'A categorization of the guest type, which may influence reporting
      or analytics.

      '
  - name: AGE
    description: 'The age of the guest, which can be used for demographic analysis
      or age-based reporting.

      '
  - name: AGE_CATEGORY
    description: 'A categorical representation of the guest''s age, potentially used
      for grouping or filtering purposes.

      '
  - name: GENDER
    description: 'The gender of the guest, used for demographic analysis or reporting.

      '
  - name: IS_DUMMY
    description: 'A flag indicating whether the guest record is a dummy or placeholder
      entry.

      '
  - name: PARENT_GUEST_ID
    description: 'The identifier of a parent or associated guest, potentially used
      to track relationships between guests.

      '
  - name: SECRET_SEED
    description: 'A secret seed value associated with the guest, potentially used
      for encryption or security purposes.

      '
  - name: SECRET_CODE
    description: 'A secret code linked to the guest, used for secure identification
      or authentication.

      '
  - name: LAST_UPDATED_TIMESTAMP
    description: 'The timestamp when the guest record was last updated in the source
      system.

      '
  - name: SOURCE_DELETED
    description: 'A flag indicating whether the guest record has been deleted in the
      source system.

      '
  - name: FULL_NAME
    description: The full name of the guest, used for reporting or identification
      purposes.
